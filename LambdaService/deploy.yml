parameters:
- name: buildDirectories
  type: object

steps:
- script: mkdir -p terraform/build/
  displayName: Make Lambda .zip Directory

- ${{ each sourceDirectory in parameters.buildDirectories }}:
  - download: current
    artifact: lambda-${{ sourceDirectory.name }}
    displayName: Get ${{ sourceDirectory.name }} Artifact

  - script: mv $(Pipeline.Workspace)/lambda-${{ sourceDirectory.name }}/* terraform/build
    displayName: Stage ${{ sourceDirectory.name }} Artifact
