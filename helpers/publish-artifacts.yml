parameters:
- name: artifactName
  type: string
- name: steps
  type: stepList

steps:
- script: |
    path=$(Pipeline.Workspace)/${{ parameters.artifactName }}-$(System.JobId)
    mkdir $path
    echo "##vso[task.setvariable variable=path;isOutput=true]$path"
  name: artifactDirectory
  displayName: Make Artifact Directory

- ${{ each step in parameters.steps }}:
  - ${{ step }}

- publish: $(artifactDirectory.path)
  artifact: ${{ parameters.artifactName }}
  displayName: Publish Artifact